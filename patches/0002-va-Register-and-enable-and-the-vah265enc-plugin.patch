From ba2f7a0a54cd1d97300a80ca8dd838190eeccee3 Mon Sep 17 00:00:00 2001
From: He Junyan <junyan.he@intel.com>
Date: Fri, 25 Mar 2022 21:55:28 +0800
Subject: [PATCH 2/8] va: Register and enable and the vah265enc plugin.

---
 subprojects/gst-plugins-bad/sys/va/plugin.c | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/subprojects/gst-plugins-bad/sys/va/plugin.c b/subprojects/gst-plugins-bad/sys/va/plugin.c
index 31c3873ab8..937fa04e7b 100644
--- a/subprojects/gst-plugins-bad/sys/va/plugin.c
+++ b/subprojects/gst-plugins-bad/sys/va/plugin.c
@@ -36,6 +36,7 @@
 #include "gstvah264dec.h"
 #include "gstvah264enc.h"
 #include "gstvah265dec.h"
+#include "gstvah265enc.h"
 #include "gstvajpegdec.h"
 #include "gstvampeg2dec.h"
 #include "gstvaprofile.h"
@@ -195,6 +196,13 @@ plugin_register_encoders (GstPlugin * plugin, GstVaDevice * device,
               device->render_device_path);
         }
         break;
+      case HEVC:
+        if (!gst_va_h265_enc_register (plugin, device, sinkcaps, srccaps,
+                GST_RANK_NONE, entrypoint)) {
+          GST_WARNING ("Failed to register H265 encoder: %s",
+              device->render_device_path);
+        }
+        break;
       default:
         GST_DEBUG ("No encoder implementation for %" GST_FOURCC_FORMAT,
             GST_FOURCC_ARGS (codec));
-- 
2.25.1

