From b68b5a2a0b86ad39f507c445b3f927abaaa97030 Mon Sep 17 00:00:00 2001
From: He Junyan <junyan.he@intel.com>
Date: Tue, 2 Apr 2024 22:47:58 +0800
Subject: [PATCH 13/24] va: libs: Use va_check_surface_has_status() to
 implement va_check_surface()

---
 .../gst-libs/gst/va/vasurfaceimage.c                | 13 +------------
 1 file changed, 1 insertion(+), 12 deletions(-)

diff --git a/subprojects/gst-plugins-bad/gst-libs/gst/va/vasurfaceimage.c b/subprojects/gst-plugins-bad/gst-libs/gst/va/vasurfaceimage.c
index c2498f88af..6b29868d6d 100644
--- a/subprojects/gst-plugins-bad/gst-libs/gst/va/vasurfaceimage.c
+++ b/subprojects/gst-plugins-bad/gst-libs/gst/va/vasurfaceimage.c
@@ -369,18 +369,7 @@ va_ensure_image (GstVaDisplay * display, VASurfaceID surface,
 gboolean
 va_check_surface (GstVaDisplay * display, VASurfaceID surface)
 {
-  VADisplay dpy = gst_va_display_get_va_dpy (display);
-  VAStatus status;
-  VASurfaceStatus state;
-
-  status = vaQuerySurfaceStatus (dpy, surface, &state);
-
-  if (status != VA_STATUS_SUCCESS)
-    GST_ERROR ("vaQuerySurfaceStatus: %s", vaErrorStr (status));
-
-  GST_LOG ("surface %#x status %d", surface, state);
-
-  return (status == VA_STATUS_SUCCESS);
+  return va_check_surface_has_status (display, surface, 0);
 }
 
 gboolean
-- 
2.25.1

